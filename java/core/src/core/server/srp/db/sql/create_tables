CREATE TABLE IF NOT EXISTS registry (
	k VARCHAR(50),
	v VARCHAR(255),
	mark	TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (k)
);

INSERT IGNORE INTO registry (k,v) VALUES ("max_users", "1000");

CREATE TABLE IF NOT EXISTS user (
	version VARCHAR(50),
	id      INTEGER AUTO_INCREMENT,
	name 	VARCHAR(255) NOT NULL DEFAULT '',
	v		TEXT,
	s		TEXT,
	mark	TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (name),
	UNIQUE KEY (id) 
);

CREATE TABLE IF NOT EXISTS mail_block (
	user_id	INTEGER,
	block	TEXT,
	mark TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (user_id)
);

CREATE TABLE IF NOT EXISTS key_block (
	user_id	INTEGER,
	block	TEXT,
	mark TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (user_id)
);

CREATE TABLE IF NOT EXISTS failure (
	user_id	INTEGER,
	mark	TIMESTAMP,
	PRIMARY KEY (user_id)
);

CREATE TABLE IF NOT EXISTS deleted_user (
	version VARCHAR(50),
	id      INTEGER AUTO_INCREMENT,
	name 	VARCHAR(255) NOT NULL DEFAULT '',
	v		TEXT,
	s		TEXT,
	mark	TIMESTAMP NULL DEFAULT NULL,
	deleted	TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (id) 
);

CREATE TABLE IF NOT EXISTS deleted_mail_block LIKE mail_block;
CREATE TABLE IF NOT EXISTS deleted_key_block LIKE key_block;
	